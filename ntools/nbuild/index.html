<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="naz-hage" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Nbuild - Ntools</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Nbuild";
        var mkdocs_page_input_path = "ntools/nbuild.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Ntools
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../installation/">Installation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../usage/">Usage</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Ntools</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../nbackup/">Nbackup</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Nbuild</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#nbuildtargets">nbuild.targets</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#commontargets">common.targets</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../nbuildtasks/">NbuildTasks</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ngit/">Ngit</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Additional information</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../additional-information/">Additional information</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../changelog/">Changelog</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Ntools</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Ntools</li>
      <li class="breadcrumb-item active">Nbuild</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/naz-hage/ntools/edit/main/docs/ntools/nbuild.md">Edit on ntools</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h2 id="nbuild">Nbuild</h2>
<p><code>Nbuild</code> (<code>Nb</code>) is a tool that launches MSBuild with a target to build.</p>
<ul>
<li>Nb.exe is a command line tool that installs the development tools and runtimes required to build and test the solution. It is a wrapper for MSBuild and provides a simplified interface for building solutions. It also provides a way to define and run custom targets.</li>
<li>To run a target type <code>Nb.exe [Target Name]</code></li>
<li>The list of targets is generated by running <code>Nb.exe -c targets</code> command.</li>
</ul>
<p><strong>Expects:</strong></p>
<ul>
<li><code>nbuild.targets</code> file in the solution folder.</li>
<li><code>common.targets</code> file in <code>$(ProgramFiles)\Nbuild</code>.</li>
</ul>
<p>More details on <code>nbuild.targets</code> and <code>common.targets</code> can be found at the end of this section.</p>
<p><strong>Generates:</strong></p>
<ul>
<li><code>nbuild.bat</code> used to run MSBuild to build any target defined in <code>*.targets</code> files.</li>
<li><a href="./targets.md"><code>targets.md</code></a> which lists all the targets defined in <code>*.targets</code> files.</li>
</ul>
<h3 id="usage">Usage</h3>
<pre><code class="language-cmd"> Nb.exe [-c value] [-json value] [-v value]
  - c    : Specifies the command to execute. Possible values: targets, install, uninstall, download, list.
         targets         -&gt; Lists available targets and saves them in the targets.md file.
         install         -&gt; Downloads and installs apps specified in the -json option.
         uninstall       -&gt; Uninstalls apps specified in the -json option.
         download        -&gt; Downloads apps specified in the -json option.
         list            -&gt; Lists apps specified in the -json option.
         ----
         - By default, the -json option points to the `NTools` deployment folder: $(ProgramFiles)\build\tools.json.
         - The install, uninstall, and download commands require admin privileges to run. (string, default=)
  - json : Specifies the JSON file that holds the list of apps. Only valid for the install, download, and list commands.
         Sample JSON file: https://github.com/naz-hage/`NTools`/blob/main/Nbuild/resources/app-`NTools`.json
          (string, default=$(ProgramFiles)\nbuild\`NTools`.json)
  - v    : Optional parameter which sets the console output verbose level
         ----
         - if no command line options are specified with the -v option , i.e.: 'Nb.exe staging -v true`
           `Nb` will run an MSbuild target `staging` defined in a `nbuild.targets` file which present in the solution folder.
           Run `Nb.exe -t Targets` to list the available targets.
         -v Possible Values: (true or false, default=False)
</code></pre>
<p><strong>If the -json option is not specified, the default json file <code>$(ProgramFiles)\Nbuild\</code>NTools<code>.json</code> is used if it exists</strong>. </p>
<h3 id="examples">Examples</h3>
<p>Open a Terminal and navigate to your solution folder.</p>
<ul>
<li>Build a solution:</li>
</ul>
<pre><code class="language-cmd">Nb.exe solution
</code></pre>
<ul>
<li>Clean a solution:</li>
</ul>
<pre><code class="language-cmd">Nb.exe clean
</code></pre>
<ul>
<li>Run tests on a solution:</li>
</ul>
<pre><code class="language-cmd">Nb.exe test
</code></pre>
<ul>
<li>Create a staging build:</li>
</ul>
<pre><code class="language-cmd">Nb.exe staging
</code></pre>
<ul>
<li>Display available options:</li>
</ul>
<pre><code class="language-cmd">Nb.exe -c targets
</code></pre>
<h3 id="nbuildtargets">nbuild.targets</h3>
<ul>
<li><code>nbuild.targets</code> is a MSBuild file that imports <code>common.targets</code>.</li>
<li>The following properties are required in <code>nbuild.targets</code>:<ul>
<li>SolutionName: The name of the solution file.</li>
</ul>
</li>
</ul>
<pre><code class="language-xml">&lt;PropertyGroup&gt;
    &lt;!--The GUID should be replaced with the solution name--&gt;
    &lt;SolutionName&gt;&lt;/SolutionName&gt;
    &lt;DeploymentFolder&gt;$(ProgramFiles)\Nbuild&lt;/DeploymentFolder&gt;
    &lt;/PropertyGroup&gt;
</code></pre>
<ul>
<li>The following target is required in <code>nbuild.targets</code>:<ul>
<li>ARTIFACTS: The folder where the artifacts are copied to.</li>
</ul>
</li>
</ul>
<pre><code class="language-xml">&lt;Target Name=&quot;ARTIFACTS&quot; DependsOnTargets=&quot;TAG&quot;&gt;
&lt;!--The folder where the artifacts are copied to--&gt;
&lt;ItemGroup&gt;
    &lt;BinaryFiles Include=&quot;$(Solut
</code></pre>
<h3 id="commontargets">common.targets</h3>
<ul>
<li>
<p><code>common.targets</code> is imported by <code>nbuild.targets</code>.</p>
</li>
<li>
<p>Common TARGETS:</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>Target Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>PROPERTIES</td>
<td>Sets up properties for the build process, reads the Git tag, checks if essential properties are defined, and prints out some properties and git information.</td>
</tr>
<tr>
<td>CLEAN</td>
<td>Cleans the solution by removing the output directories and deleting the obj directories.</td>
</tr>
<tr>
<td>STAGING</td>
<td>Executes a series of targets for staging: CLEAN, TAG, AUTOTAG_STAGING, SOLUTION, TEST, SAVE_ARTIFACTS, PACKAGE.</td>
</tr>
<tr>
<td>STAGING_DEPLOY</td>
<td>Executes the STAGING target and then the DEPLOY target.</td>
</tr>
<tr>
<td>PRODUCTION</td>
<td>Executes a series of targets for production: CLEAN, TAG,</td>
</tr>
<tr>
<td>PRODUCTION_DEPLOY</td>
<td>Executes the PRODUCTION target and then the DEPLOY target.</td>
</tr>
<tr>
<td>AUTOTAG_STAGING</td>
<td>Sets the build type to STAGING.</td>
</tr>
<tr>
<td>AUTOTAG_PRODUCTION</td>
<td>Sets the build type to PRODUCTION and updates the main branch of the git repository.</td>
</tr>
<tr>
<td>AUTOTAG_PRODUCTION</td>
<td>Increments version for a production build, but only if the current branch is 'main'</td>
</tr>
<tr>
<td>GIT_TAG</td>
<td>Commits changes to the git repository, pulls the latest changes, pushes the changes, and creates a tag.</td>
</tr>
<tr>
<td>AUTOTAG</td>
<td>Gets the git branch, reads the build type, and automatically creates a tag based on the branch and build type.</td>
</tr>
<tr>
<td>SOLUTION</td>
<td>Builds the solution using the <code>dotnet build</code> command with the specified configuration, version, and culture.</td>
</tr>
<tr>
<td>SOLUTION_MSBUILD</td>
<td>Restores the solution's dependencies with <code>dotnet restore</code> and then builds the solution using MSBuild with the specified configuration, platform, version, and culture.</td>
</tr>
<tr>
<td>PACKAGE</td>
<td>Creates a zip file of the artifacts folder and then removes the artifacts folder.</td>
</tr>
<tr>
<td>SAVE_ARTIFACTS</td>
<td>Copies various types of files (binary files, EnUSFiles, ref, RunTimesLib, Default, RunTimesLibNet, RunTimesNetStandard20, RunTimesNative) to the artifacts folder.</td>
</tr>
<tr>
<td>Deploy</td>
<td>Checks if the user is an administrator and if the DeploymentFolder property is defined. If both conditions are met, it extracts the zip file of the artifacts folder to the deployment folder and then removes the setup folder.</td>
</tr>
<tr>
<td>TEST</td>
<td>Runs tests on the solution with the <code>dotnet test</code> command with the specified configuration and logger settings.</td>
</tr>
<tr>
<td>TEST_RELEASE</td>
<td>Similar to TEST, but uses the release configuration.</td>
</tr>
<tr>
<td>SingleProject</td>
<td>Demonstrate how to build a single projec. Builds a specific project (<code>nbuild\nbuild.csproj</code>) using the <code>dotnet build</code> command with the specified configuration, runtime, version.</td>
</tr>
<tr>
<td>IS_ADMIN</td>
<td>Checks if the user is an administrator by running the <code>net session</code> command and sets the <code>IsAdmin</code> property based on the exit code.</td>
</tr>
<tr>
<td>GIT_STATUS</td>
<td>Displays the current git status</td>
</tr>
<tr>
<td>AUTOTAG_STAGING</td>
<td>Increments version for a staging build</td>
</tr>
<tr>
<td>SET_TAG</td>
<td>Sets version for a staging build</td>
</tr>
<tr>
<td>GIT_PULL</td>
<td>Pulls the latest changes from git</td>
</tr>
<tr>
<td>TAG</td>
<td>Gets the latest tag from git</td>
</tr>
<tr>
<td>PUSH_TAG</td>
<td>Pushes the current tag to the remote repository</td>
</tr>
<tr>
<td>GIT_BRANCH</td>
<td>Gets the current branch from git</td>
</tr>
<tr>
<td>HandleError</td>
<td>Prints a high importance message stating that an error occurred while reading the version file.</td>
</tr>
</tbody>
</table>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../nbackup/" class="btn btn-neutral float-left" title="Nbackup"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../nbuildtasks/" class="btn btn-neutral float-right" title="NbuildTasks">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../nbackup/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../nbuildtasks/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
